"use strict";angular.module("leseulsteve.userAuth",["ngAnimate","LocalStorageModule"]),angular.module("angular.userAuth").config(["localStorageServiceProvider","$httpProvider",function(a,b){a.setPrefix("userAuth"),b.interceptors.push(["$q","localStorageService","$rootScope",function(a,b,c){return{request:function(a){a.headers=a.headers||{};var c=b.get("token");return c&&(a.headers.Authorization="Bearer "+c),a},responseError:function(b){switch(b.status){case 401:c.$broadcast("UserAuth:request:unauthorized",b)}return a.reject(b)}}}])}]),angular.module("angular.userAuth").provider("UserAuth",function(){var a={};return{config:function(b){_.extend(a,b)},$get:["$http","$location","localStorageService","$rootScope",function(b,c,d,e){function f(a,b){return b.then(function(b){return e.$broadcast("UserAuth:"+a+":success",b.data),b.data})["catch"](function(b){return e.$broadcast("UserAuth:"+a+":fail",b.data),b.data})}function g(a){if(a)d.set("token",a.data.token.id),d.set("token-expiration",a.data.token.expiration);else{var b=c.search().token;d.set("token",b)}}var h={signin:"signin",sendPasswordToken:"send_password_token",changePassword:"change_passport",signup:"signup",confirmEmail:"confirm_email"};return _.forOwn(h,function(b,c){h[c]=a.apiRoot+"/auth/"+b}),{config:a,signin:function(a){return b.post(h.signin,a).then(function(a){g(a),e.$broadcast("UserAuth:signin:success",a.data.user)})["catch"](function(a){e.$broadcast("UserAuth:signin:fail",a.data)})},sendPasswordToken:function(c){return f("sendPasswordToken",b.post(h.sendPasswordToken,{username:c,urlRedirection:a.sendPasswordToken.urlRedirection}))},changePassword:function(a){return g(),f("changePassword",b.post(h.changePassword,{newPassword:a}))},signup:function(c){return f("signup",b.post(h.signup,{newUser:c,urlRedirection:a.confirmEmail.urlRedirection}))},confirmEmail:function(){return g(),f("confirmEmail",b.post(h.confirmEmail))}}}]}}),angular.module("angular.userAuth").directive("loginForm",["$animate","UserAuth",function(a,b){return{restrict:"A",link:function(c,d){c.signin=function(c,e){c.$invalid&&b.config.signinForm.animate&&a.addClass(d,"shake").then(function(){a.removeClass(d,"shake")}),c.$valid&&b.signin(e)}}}}]);
//# sourceMappingURL=angular-user-auth.min.js.map